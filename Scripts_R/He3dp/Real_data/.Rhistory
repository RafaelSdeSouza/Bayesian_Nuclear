Model <- "model{
# LIKELIHOOD
for (i in 1:N) {
obsy[i] ~ dnorm(y[i], pow(erry[i], -2))
y[i] ~ dnorm(scale[re[i]]*sfactor3Hedp(obsx[i], e1, ex, gin, gout,ri,rf,ue[ik[i]]),pow(tau, -2))
res[i] <- obsy[i]-sfactor3Hedp(obsx[i], e1,ex, gin, gout,ri,rf,0)
}
RSS <- sum(res^2)
# Predicted values
for (j in 1:M){
# Bare...
mux0[j] <- sfactor3Hedp(xx[j], e1,ex, gin, gout,ri,rf,0)
yx0[j] ~ dnorm(mux0[j],pow(tau,-2))
# No inverse Kinematics
mux1[j] <- sfactor3Hedp(xx[j], e1, ex,gin, gout,ri,rf,ue[1])
yx1[j] ~ dnorm(mux1[j],pow(tau,-2))
# With inverse Kinematics
mux2[j] <- sfactor3Hedp(xx[j], e1,ex, gin, gout,ri,rf,ue[2])
yx2[j] ~ dnorm(mux1[j],pow(tau,-2))
}
for (k in 1:Nre){
scale[k] ~ dlnorm(log(1.0),1/log(1+pow(syst[k],2)))
}
for (z in 1:Nik){
ue[z] ~ dnorm(0,1e3)T(0,)
}
# PRIORS
# Wigner limit: wl = hbar^2/(m_red a_c^2) = 41.80159/(M_red a_c^2)
#
# deuteron channel: wl_d = 41.80159/(1.207357 a_c^2) = 34.6224/a_c^2
# neutron channel:  wl_n = 41.80159/(0.805597 a_c^2) = 51.8889/a_c^2
# e1, gin, gout are defined as in tdn.f (by Alain Coc):
# resonance energy, initial reduced width, final reduced
# width;
tau ~  dt(0, pow(2.5,-2), 1)T(0,)
#e1 ~  dt(0, pow(2.5,-2), 1)T(0,)
#ex ~  dt(0, pow(2.5,-2), 1)T(0,)
e1 ~  dnorm(0.25,pow(0.25,-2))T(0,)
deltaE ~ dnorm(0,pow(0.05,-2))
ex <-  e1
#+ deltaE
#rf ~  dnorm(4, pow(2.5,-2))T(0,)
#ri ~  dnorm(4, pow(2.5,-2))T(0,)
#rf ~  dnorm(5, pow(0.5,-2))T(3,)
#ri ~  dnorm(5, pow(0.5,-2))T(3,)
rf ~  dnorm(5, pow(0.01,-2))T(3,)
ri ~  dnorm(5, pow(0.01,-2))T(3,)
gout ~ dnorm(0,pow(0.5,-2))T(0,5)
gin ~ dnorm(0,pow(0.5,-2))T(0,5)
}"
######################################################################
# n.adapt:  number of iterations in the chain for adaptation (n.adapt)
#           [JAGS will use to choose the sampler and to assure optimum
#           mixing of the MCMC chain; will be discarded]
# n.udpate: number of iterations for burnin; these will be discarded to
#           allow the chain to converge before iterations are stored
# n.iter:   number of iterations to store in the final chain as samples
#           from the posterior distribution
# n.chains: number of mcmc chains
# n.thin:   store every n.thin element [=1 keeps all samples]
inits <- function () { list(deltaE = runif(1,0.1,0.9),e1 = runif(1,0.1,0.9),gout=runif(1,0.01,0.5),gin=runif(1,0.01,0.5)) }
# "f": is the model specification from above;
# data = list(...): define all data elements that are referenced in the
inits <- function () { list(deltaE = runif(1,0.1,0.9),e1 = runif(1,0.1,0.9),gout=runif(1,0.01,0.5),gin=runif(1,0.01,0.5)) }
# "f": is the model specification from above;
# data = list(...): define all data elements that are referenced in the
# JAGS model with R2Jags;
Normfit <- jags(data = model.data,
inits = inits,
parameters.to.save  = c("e1", "ex","gin", "gout","ue","tau", "ri","rf","RSS","mux0","mux1","mux2","scale"),
model.file  = textConnection(Model),
n.thin = 1,
n.chains = 3,
n.burnin = 10000,
n.iter = 15000)
jagsresults(x = Normfit , params = c("e1", "ex","gin", "gout","ue","tau","ri","rf"),probs = c(0.005,0.025, 0.25, 0.5, 0.75, 0.975,0.995))
traplot(Normfit  ,c("e1", "ex","gin", "gout","ue","tau","ri","rf"),style="plain")
dummy <- as.mcmc(Normfit)[,c("e1","gin", "gout","ri","rf")]
pair_wise_plot(ggs(dummy))
Sp <- ggs(as.mcmc(Normfit)[,c("e1", "gin", "gout","ri","rf")])
Sp0 <- Sp %>% as_tibble()
#%>% mutate(value = ifelse(Parameter == 'e1', 10*value, value))
levels(Sp0$Parameter) <- as.factor(c("E[r]","gamma[d]^2", "gamma[p]^2","a[c]^i","a[c]^f"))
pair_wise_plot(Sp0)
pdf("plot/He3dp_corr.pdf",height = 8,width =8)
pair_wise_plot(Sp0)
dev.off()
Nsamp <- 500
mcdat <- as.data.frame(do.call(rbind, as.mcmc(Normfit)[,c("e1","gin","gout")]))
index <- sample(1:nrow(mcdat),size=Nsamp,replace=FALSE)
mcdat <- mcdat[index,]
Tgrid <- exp(seq(log(1e-3),log(10),length.out =  100))
gdat <- list()
for(i in 1:Nsamp){
y <- sapply(Tgrid,nuclear_rate3Hedp,ER = mcdat[i,1],gi = mcdat[i,2],gf = mcdat[i,3])
dd <- data.frame(y)
gdat[[i]] <- dd
}
gg <-  as.data.frame(gdat)
gg$x <- Tgrid
gg2<-apply(gg, 1, quantile, probs=c(0.005,0.025, 0.25, 0.5, 0.75, 0.975,0.995), na.rm=TRUE)
gg2data <- data.frame(x =Tgrid, mean = gg2["50%",],lwr1=gg2["25%",],
lwr2 = gg2["2.5%",],lwr3=gg2["0.5%",],upr1=gg2["75%",],
upr2=gg2["97.5%",],upr3=gg2["99.5%",])
ggplot(gg2data,aes(x=x,y=mean))+
theme_bw()  +
geom_ribbon(data=gg2data,aes(x=Tgrid,ymin=lwr3, ymax=upr3,y=NULL), fill=c("#ffeda0"),show.legend=FALSE) +
geom_ribbon(data=gg2data,aes(x=Tgrid,ymin=lwr2, ymax=upr2,y=NULL), fill=c("#feb24c"),show.legend=FALSE) +
geom_ribbon(data=gg2data,aes(x=Tgrid,ymin=lwr1, ymax=upr1,y=NULL), fill=c("#f03b20"),show.legend=FALSE) +
xlab("Temperature (GK)") + ylab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361"))) +
scale_y_continuous(breaks=c(0,5e7,1e8,1.5e8),labels=c(0,expression(5%*%10^7),
expression(10^8),expression(1.5%*%10^8))) +
theme(legend.position = "none",
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "gray95"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=17.5),
axis.text  = element_text(size=13),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
cmb <- as.data.frame(filter(gg, x <= 1.1 & x >= 0.9))
cmbhist <- data.frame(x=as.numeric(cmb)[1:Nsamp])
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 10,fill="#f03b20",color="#feb24c") +
theme_bw() +
#  scale_x_continuous(breaks = scales::pretty_breaks(n = 3)) +
scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#feb24c") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
gg
as.data.frame(filter(gg, x <= 1.1 & x >= 0.9))
cmb <- as.data.frame(filter(gg, x <= 1.1 & x >= 0.9))
cmbhist <- data.frame(x=as.numeric(cmb)[1:Nsamp])
as.numeric(cmb)
cmb
as.numeric(cmb)
cmb
gg
hist(gg)
gg$x
head(gg)
cmb
dim(gg)
gg$x
cmb
dim(cmb)
cmb[2,]
cmb[1,]
cmb[,1]
cmb[,2]
cmb <- t(as.data.frame(filter(gg, x <= 1.1 & x >= 0.9)))
dim(cmb)
cmb[1,]
cmb[,1]
cmb[1:Nsamp]
cmb <- as.data.frame(filter(gg, x <= 1.1 & x >= 0.9))
cmbhist <- data.frame(x=cmb[1:Nsamp])
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 10,fill="#f03b20",color="#feb24c") +
theme_bw() +
#  scale_x_continuous(breaks = scales::pretty_breaks(n = 3)) +
scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#feb24c") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
cmbhist
cmb <- as.data.frame(filter(gg, x <= 1.1 & x >= 0.9))
data.frame(x=cmb[1:Nsamp])
dim(cmbhist)
cmb
cmb[1:Nsamp]
cmb <- as.data.frame(filter(gg, x <= 1.1 & x >= 0.9))
cmb[1:Nsamp]
as.numeric(cmb[1:Nsamp])
as.numeric(cmb)[1:Nsamp]
cmb
as.data.frame(filter(gg, x <= 1.1 & x >= 0.9))
gg
gg
cmb
data.frame(x=cmb[1:Nsamp])
as.numeric(cmb[1:Nsamp])
as.list(cmb[1:Nsamp])
dim(cmb)
cmb[1,1:2]
cmb[2,1:2]
cmb <- as.data.frame(filter(gg, x <= 1.1 & x >= 0.9))
cmb[2,1:2]
cmb[1,1:2]
cmb <- as.data.frame(filter(gg, x <= 1.05 & x >= 0.95))
cmb[1,1:2]
as.numeric(cmb[1:Nsamp])
cmbhist <- data.frame(x=as.numeric(cmb[1:Nsamp]))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 10,fill="#f03b20",color="#feb24c") +
theme_bw() +
#  scale_x_continuous(breaks = scales::pretty_breaks(n = 3)) +
scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#feb24c") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 20,fill="#f03b20",color="#feb24c") +
theme_bw() +
#  scale_x_continuous(breaks = scales::pretty_breaks(n = 3)) +
scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#feb24c") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#f03b20",color="#feb24c") +
theme_bw() +
#  scale_x_continuous(breaks = scales::pretty_breaks(n = 3)) +
scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#feb24c") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#f03b20",color="#feb24c") +
theme_bw() +
#  scale_x_continuous(breaks = scales::pretty_breaks(n = 3)) +
scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "gray") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="gray",color="#feb24c") +
theme_bw() +
#  scale_x_continuous(breaks = scales::pretty_breaks(n = 3)) +
scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#feb24c") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#f03b20",color="#feb24c") +
theme_bw() +
#  scale_x_continuous(breaks = scales::pretty_breaks(n = 3)) +
scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#feb24c") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#f03b20",color="#feb24c")
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#f03b20",color="#feb24c") +
theme_bw()
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#f03b20",color="#feb24c") +
theme_bw() +
#  scale_x_continuous(breaks = scales::pretty_breaks(n = 3)) +
#  scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
#                             expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#feb24c") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#f03b20",color="#feb24c") +
theme_bw() +
scale_x_continuous(breaks = scales::pretty_breaks(n = 3)) +
#  scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
#                             expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#feb24c") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#f03b20",color="#feb24c") +
theme_bw() +
scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) +
#  scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
#                             expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#feb24c") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
pdf("plot/He3dp_hist_cmb.pdf",height = 7,width = 10)
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#f03b20",color="#feb24c") +
theme_bw() +
scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) +
#  scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
#                             expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#feb24c") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
dev.off()
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#4357a3",color="#feb24c") +
theme_bw() +
scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) +
#  scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
#                             expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#d84951") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#4357a3",color="#feb24c") +
theme_bw() +
scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) +
#  scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
#                             expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#d84951") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#4357a3",color="#F0B27A") +
theme_bw() +
scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) +
#  scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
#                             expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#d84951") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#4357a3",color="#d84951") +
theme_bw() +
scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) +
#  scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
#                             expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#d84951") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
pdf("plot/He3dp_hist_cmb.pdf",height = 7,width = 10)
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#4357a3",color="#d84951") +
theme_bw() +
scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) +
#  scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
#                             expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#d84951") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
dev.off()
pdf("plot/He3dp_hist_cmb.pdf",height = 7,width = 8)
ggplot(cmbhist, aes(x)) +
geom_histogram(aes(y=..count../sum(..count..)),bins = 15,fill="#4357a3",color="#d84951") +
theme_bw() +
scale_x_continuous(breaks = scales::pretty_breaks(n = 5)) +
#  scale_x_continuous(breaks=c(1.15e8,1.2e8,1.25e8),labels=c(expression(1.15%*%10^8),
#                             expression(1.20%*%10^8),expression(1.25%*%10^8))) +
geom_rug(sides = "b", aes(y = 0),colour = "#d84951") +
theme(legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=15),
strip.text = element_text(size=15),
strip.background = element_rect("#F0B27A"),panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
ylab("Posterior probability") + xlab(expression(N[A]~symbol("\341")*sigma*nu*symbol("\361")))
dev.off()
