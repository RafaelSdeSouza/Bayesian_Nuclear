set <- ensamble$dat
lab <- ensamble$invK
syst = c(0.03,unique(ensamble$Syst))
#syst <- syst[-3]
M <- 500
xx <- seq(min(obsx),max(obsx),length.out = M)
model.data <- list(obsy = obsy,    # Response variable
obsy2 = obsy,    # Response variable
obsx =  obsx,   # Predictors
erry = erry,
N = nrow(ensamble), # Sample size
syst = syst,
Nre = Nre,
re = re,
Nik = Nik,
ik  = ik,
M = M,
xx = xx
#                  ap  = 5,
#                  ad = 6
)
# Conservative case
######################################################################
Model <- "model{
# LIKELIHOOD informative
for (i in 1:N) {
obsy[i] ~ dnorm(y[i], pow(erry[i], -2))
y[i] ~ dnorm(scale[re[i]]*sfactor3Hedp(obsx[i], E0, Er, gd2, gp2, ad, ap, ue[ik[i]]), pow(tau, -2))
res[i] <- obsy[i]-sfactor3Hedp(obsx[i], E0, Er, gd2, gp2, ad, ap,0)
}
# LIKELIHOOD broad
for (i in 1:N) {
obsy2[i] ~ dnorm(y_2[i], pow(erry[i], -2))
y_2[i] ~ dnorm(scale[re[i]]*sfactor3Hedp(obsx[i],  E0_b, Er_b, gd2_b, gp2_b, ad_b, ap_b, ue[ik[i]]),pow(tau_2, -2))
}
RSS <- sum(res^2)
# Predicted values
for (j in 1:M){
# Bare...
mux0[j] <- sfactor3Hedp(xx[j], E0, Er, gd2, gp2, ad, ap,0)
mux0_2[j] <- sfactor3Hedp(xx[j], E0_b, Er_b, gd2_b, gp2_b, ad_b, ap_b,0)
DeltaM[j] <- mux0[j]/mux0_2[j]
# No inverse Kinematics
mux1[j] <- sfactor3Hedp(xx[j], E0, Er, gd2, gp2, ad, ap,ue[1])
yx1[j] ~ dnorm(mux1[j],pow(tau,-2))
# With inverse Kinematics
mux2[j] <- sfactor3Hedp(xx[j], E0, Er, gd2, gp2, ad, ap,ue[2])
yx2[j] ~ dnorm(mux1[j],pow(tau,-2))
}
for (k in 1:Nre){
scale[k] ~ dlnorm(log(1.0),1/log(1+pow(syst[k],2)))
}
for (z in 1:Nik){
ue[z] ~ dnorm(0,pow(0.1,-2))T(0,)
}
# PRIORS
# Case I
tau ~  dnorm(0, pow(1,-2))T(0,)
E0  ~  dnorm(0, pow(1,-2))T(0,)
Er <-  E0
gd2 ~  dnorm(0, pow(3,-2))T(0,)
gp2 ~  dnorm(0, pow(3,-2))T(0,)
ad  ~  dnorm(6, pow(0.01,-2))T(0,)
ap  ~  dnorm(5, pow(0.01,-2))T(0,)
# Case II
tau_2  ~    dnorm(0, pow(1,-2))T(0,)
Er_b  ~   dbeta(0.5,0.5)
E0_b  ~   dbeta(2,5)
gp2_b ~  dnorm(0, pow(3,-2))T(0,)
gd2_b  ~ dnorm(0, pow(3,-2))T(0,)
ad_b  ~  dunif(2,10)
ap_b  ~  dunif(2,10)
ue_ev[1] <-1e6*ue[1]
ue_ev[2] <-1e6*ue[2]
S_0   <- sfactor3Hedp(1e-4, E0, Er, gd2, gp2, ad, ap,0)
S_0b  <- sfactor3Hedp(1e-4, E0_b, Er_b, gd2_b, gp2_b, ad_b, ap_b,0)
}"
inits <- function () { list(E0 = runif(1,0.3,0.35),E0_b = 0.4,Er_b = 0.4,gd2 = 1,
gp2 = runif(1,0.01,0.1),gd2_b = 0.5) }
# JAGS model with R2Jags;
Normfit <- jags(data = model.data,
inits = inits,
parameters.to.save  = c("Er","E0","gd2", "gp2","ue_ev","tau", "ad","ap",
"RSS","mux0","mux1","mux2","scale","DeltaM","S_0",
"S_0b","E0_b","Er_b","gd2_b",
"gp2_b","tau_2","ad_b","ap_b" ),
model.file  = textConnection(Model),
n.thin = 30,
n.chains = 5,
n.burnin = 5000,
n.iter = 10000)
set.seed(1234)
# JAGS model with R2Jags;
Normfit <- jags(data = model.data,
inits = inits,
parameters.to.save  = c("Er","E0","gd2", "gp2","ue_ev","tau", "ad","ap",
"RSS","mux0","mux1","mux2","scale","DeltaM","S_0",
"S_0b","E0_b","Er_b","gd2_b",
"gp2_b","tau_2","ad_b","ap_b" ),
model.file  = textConnection(Model),
n.thin = 30,
n.chains = 5,
n.burnin = 5000,
n.iter = 10000)
jagsresults(x = Normfit, params = c("E0","gd2", "gp2","ue","tau", "ad","ap","ue_ev","S_0"),probs = c(0.16, 0.5, 0.84))
set.seed(24)
# JAGS model with R2Jags;
Normfit <- jags(data = model.data,
inits = inits,
parameters.to.save  = c("Er","E0","gd2", "gp2","ue_ev","tau", "ad","ap",
"RSS","mux0","mux1","mux2","scale","DeltaM","S_0",
"S_0b","E0_b","Er_b","gd2_b",
"gp2_b","tau_2","ad_b","ap_b" ),
model.file  = textConnection(Model),
n.thin = 30,
n.chains = 5,
n.burnin = 5000,
n.iter = 10000)
jagsresults(x = Normfit, params = c("E0","gd2", "gp2","ue","tau", "ad","ap","ue_ev","S_0"),probs = c(0.16, 0.5, 0.84))
Tgrid = c(0.001,0.002,0.003,0.004,0.005,0.006,0.007,0.008,0.009,0.010,0.011,0.012,
0.013,0.014,0.015,0.016,0.018,0.020,0.025,0.030,0.040,0.050,0.060,0.070,
0.080,0.090,0.100,0.110,0.120,0.130,0.140,0.150,0.160,0.180,0.200,0.250,0.300,
0.350,0.400,0.450,0.500,0.600,0.700,0.800,0.900,1.000,1.250,1.500,1.750,2.000,2.500,3.000,3.500,4.000,5.000,
6.000,7.000,8.000,9.000,10.000)
require(nuclear)
NAII <- table_reaction_He3dp(Normfit, vars=c("E0_b","Er_b","gd2_b", "gp2_b", "ad_b","ap_b"),N=800,T9=Tgrid )
NAI <- table_reaction_He3dp(Normfit, vars=c("E0","Er","gd2", "gp2", "ad","ap"),N=800,T9=Tgrid )
write.csv(NAII ,"NA_II.csv",row.names = F)
require(xtable)
NA_II_latex <- read.csv("NA_II.csv")
xl <- NA_II_latex
df1 = data.frame(xl[1:30,c(1,3,2,4,5)])
df2 = data.frame(xl[31:60,c(1,3,2,4,5)])
dfFull = data.frame(df1,df2)
x.big <- xtable(dfFull, type = "latex",display=c("e","g","E","E","E","g",
"g","E","E","E","g"),digits=4,caption= "Case I")
print(x.big, include.rownames=FALSE)
NAI_new <- NAI  %>%  mutate(data = "present") %>%
select(c("T9","mean","lower","upper")) %>%
set_colnames(c("T9","Adopted","Lower","Upper")) %>%
mutate(Adopted = Adopted/Norm) %>%
mutate(Lower = Lower/Norm) %>%
mutate(Upper = Upper/Norm)  %>%
mutate(data="presentI")
NAII_new <- NAII  %>%  mutate(data = "present") %>%
select(c("T9","mean","lower","upper")) %>%
set_colnames(c("T9","Adopted","Lower","Upper")) %>%
mutate(Adopted = Adopted/Norm) %>%
mutate(Lower = Lower/Norm) %>%
mutate(Upper = Upper/Norm)  %>%
mutate(data="presentII")
Norm <- NAII$mean
NAI_new <- NAI  %>%  mutate(data = "present") %>%
select(c("T9","mean","lower","upper")) %>%
set_colnames(c("T9","Adopted","Lower","Upper")) %>%
mutate(Adopted = Adopted/Norm) %>%
mutate(Lower = Lower/Norm) %>%
mutate(Upper = Upper/Norm)  %>%
mutate(data="presentI")
NAII_new <- NAII  %>%  mutate(data = "present") %>%
select(c("T9","mean","lower","upper")) %>%
set_colnames(c("T9","Adopted","Lower","Upper")) %>%
mutate(Adopted = Adopted/Norm) %>%
mutate(Lower = Lower/Norm) %>%
mutate(Upper = Upper/Norm)  %>%
mutate(data="presentII")
old <- read.csv("tabula-tab_he3dp.csv",header = TRUE) %>%
select(c("T9","Adopted","Lower","Upper"))  %>%
mutate(data="previous") %>%
mutate(Adopted = Adopted/Norm) %>%
mutate(Lower = Lower/Norm) %>%
mutate(Upper = Upper/Norm)
joint <- rbind(old,NAI_new,NAII_new)
joint$data <- as.factor(joint$data)
jointI_II <- filter(joint, data %in% c("presentI","presentII"))
jointI_II$data <- factor(jointI_II$data, levels = c("presentII","presentI"))
ggplot(jointI_II,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.3)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="gray90",alpha=0.4) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#606060","#ff7f00"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
print(x.big, include.rownames=FALSE)
x.big <- xtable(dfFull, type = "latex",display=c("e","g","E","E","E","g",
"g","E","E","E","g"),digits=3,caption= "Case I")
print(x.big, include.rownames=FALSE)
x.big <- xtable(dfFull, type = "latex",display=c("e","g","E","E","E","g",
"g","E","E","E","g"),digits=4,caption= "Case I")
print(x.big, include.rownames=FALSE)
ggplot(jointI_II,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.3)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="#FFE4E1",alpha=0.4) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#606060","#ff7f00"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
ggplot(jointI_II,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.3)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="#FFE4E1",alpha=0.2) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#606060","#ff7f00"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
ggplot(jointI_II,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.3)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="#F0F8FF",alpha=0.2) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#606060","#ff7f00"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
ggplot(jointI_II,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.3)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="#F0F8FF",alpha=0.2) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#606060","#D49400"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
ggplot(jointI_II,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.3)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="#F0F8FF",alpha=0.2) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#819987","#D49400"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
ggplot(jointI_II,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.5)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="#F0F8FF",alpha=0.2) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#819987","#D49400"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
ggplot(jointI_II,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.5)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="#F0F8FF",alpha=0.2) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#819987","#FFA500"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
pdf("rate_ratio_he3dp_I_II.pdf",height = 7,width = 10)
ggplot(jointI_II,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.5)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="#F0F8FF",alpha=0.2) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#819987","#FFA500"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
dev.off()
jointf <- filter(joint, data %in% c("previous","presentII"))
ggplot(jointf,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.5)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="gray90",alpha=0.4) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#819987","#6600CC"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
ggplot(jointf,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.5)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="#F0F8FF",alpha=0.4) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#819987","#6600CC"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
pdf("rate_ratio_he3dp.pdf",height = 7,width = 10)
ggplot(jointf,aes(x=T9,y=Adopted, group=data,fill=data,linetype=data,alpha=0.5)) +
geom_rect(aes(xmin=0.045, xmax=0.356, ymin=-1, ymax=22), fill="#F0F8FF",alpha=0.4) +
geom_ribbon(aes(x=T9,ymin=Lower, ymax=Upper),show.legend=FALSE) +
geom_line() +
coord_cartesian(ylim=c(0.9,1.1),xlim=c(0.00125,1)) +
theme_bw() + xlab("Temperature (GK)") + ylab("Reaction rate ratio") +
scale_fill_manual(values=c("#819987","#6600CC"),name="") +
scale_x_log10(breaks = c(0.001,0.01,0.1,1),labels=c("0.001","0.01","0.1","1"))  +
annotation_logticks(sides = "b") +
annotation_logticks(base=2.875,sides = "l") +
scale_linetype_manual(guide=F,values=c("dashed","solid"),name="",labels = c("Descouvemont", "Present","Case I")) +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(size = 3, linetype='dashed',colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(size=22),
axis.ticks = element_line(size = 0.75),
axis.line = element_line(size = 0.75, linetype = "solid"),
axis.text.y = element_text(size = 20, margin = unit(c(t = 0, r = 5, b = 0, l = 0), "mm")),
axis.text.x = element_text(size = 20, margin = unit(c(t = 5, r = 0, b = 0, l = 0), "mm")),
axis.ticks.length = unit(-3.75, "mm"),
panel.border = element_rect(size = 1.2))
dev.off()
x.big
dfFull
x.big <- xtable(dfFull[,c(1,2,5,6,1,10)], type = "latex",display=c("e","g","E","E","E","g",
"g","E","E","E","g"),digits=4,caption= "Case I")
print(x.big, include.rownames=FALSE)
dfFull[,c(1,2,5,6,1,10)]
short<- xtable(dfFull[,c(1,2,5,6,7,10)], type = "latex",display=c("e","g","E","g",
"g","g"),digits=4,caption= "Case I")
short<- xtable(dfFull[,c(1,2,5,6,7,10)], type = "latex",display=c("e","g","E","E","g",
"g","g"),digits=4,caption= "Case I")
print(short<, include.rownames=FALSE)
print(short, include.rownames=FALSE)
short<- xtable(dfFull[,c(1,2,5,6,7,10)], type = "latex",display=c("e","g","E","g","e",
"E","g"),digits=4,caption= "Case I")
print(short, include.rownames=FALSE)
short<- xtable(dfFull[,c(1,2,5,6,7,10)], type = "latex",display=c("e","g","E","e","e",
"E","g"),digits=4,caption= "Case I")
print(short, include.rownames=FALSE)
short<- xtable(dfFull[,c(1,2,5,6,7,10)], type = "latex",display=c("e","g","E","e","g",
"E","g"),digits=4,caption= "Case I")
print(short, include.rownames=FALSE)
short<- xtable(dfFull[,c(1,2,5,6,7,10)], type = "latex",display=c("e","g","E","g","g",
"E","g"),digits=4,caption= "Case I")
print(short, include.rownames=FALSE)
