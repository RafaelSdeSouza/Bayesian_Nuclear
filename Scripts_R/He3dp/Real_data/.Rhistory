quantiles <- quantile(dt$y, prob=probs)
df$quant <- factor(findInterval(df$x,quantiles))
ggplot(df, aes(x,y)) + geom_line() + geom_ribbon(aes(ymin=0, ymax=y, fill=quant)) +
scale_x_continuous(breaks=quantiles) + scale_fill_brewer(guide="none")
probs=c(0.005,0.025, 0.25, 0.5, 0.75, 0.975,0.995)
quantiles <- quantile(dt$y, prob=probs)
df$quant <- factor(findInterval(df$x,quantiles))
ggplot(df, aes(x,y)) + geom_line() + geom_ribbon(aes(ymin=0, ymax=y, fill=quant)) +
scale_x_continuous(breaks=quantiles) + scale_fill_brewer(guide="none")
quantiles <- quantile(df$y, prob=probs)
df$quant <- factor(findInterval(df$x,quantiles))
ggplot(df, aes(x,y)) + geom_line() + geom_ribbon(aes(ymin=0, ymax=y, fill=quant)) +
scale_x_continuous(breaks=quantiles) + scale_fill_brewer(guide="none")
quantile(df$y, prob=probs)
df
df <- data.frame(x=dens$x, y=dens$y)
probs=c(0.005,0.025, 0.25, 0.5, 0.75, 0.975,0.995)
quantiles <- quantile(df$y, prob=probs)
df$quant <- factor(findInterval(df$x,quantiles))
ggplot(df, aes(x,y)) + geom_line() + geom_ribbon(aes(ymin=0, ymax=y, fill=quant)) +
scale_x_continuous(breaks=quantiles) + scale_fill_brewer(guide="none")
ggplot(df, aes(x,y)) + geom_line()
ggplot(df, aes(x,y)) + geom_line() + geom_ribbon(aes(ymin=0, ymax=y, fill=quant))
df
df
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, x < 6), fill = "pink") +
geom_area(data = subset(df, x < 5), fill = "red") +
geom_area(data = subset(df, x > 1), fill = "lightgreen") +
geom_area(data = subset(df, x > 2), fill = "green") +
geom_line()
p
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant < 6), fill = "pink") +
geom_area(data = subset(df, quant < 5), fill = "red") +
geom_area(data = subset(df, quant > 1), fill = "lightgreen") +
geom_area(data = subset(df, quant > 2), fill = "green") +
geom_line()
p
df$quant <- findInterval(df$x,quantiles)
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant < 6), fill = "pink") +
geom_area(data = subset(df, quant < 5), fill = "red") +
geom_area(data = subset(df, quant > 1), fill = "lightgreen") +
geom_area(data = subset(df, quant > 2), fill = "green") +
geom_line()
p
df$quant
cmbhist <- as.numeric(cmb)[1:Nsamp]
dens <- density(cmbhist)
df <- data.frame(x=dens$x, y=dens$y)
probs=c(0.005,0.025, 0.25, 0.5, 0.75, 0.975,0.995)
quantiles <- quantile(df$y, prob=probs)
df$quant <- findInterval(df$y,quantiles)
df
df$quant
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant < 6), fill = "pink") +
geom_area(data = subset(df, quant < 5), fill = "red") +
geom_area(data = subset(df, quant > 1), fill = "lightgreen") +
geom_area(data = subset(df, quant > 2), fill = "green") +
geom_line()
p
subset(df, quant < 6)
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant > 0 & quant < 1), fill = "pink") +
geom_area(data = subset(df, quant > 1 & quant < 2), fill = "red") +
geom_area(data = subset(df, quant > 2 & quant < 3), fill = "lightgreen") +
geom_area(data = subset(df, quant > 3 & quant < 4), fill = "green") +
geom_area(data = subset(df, quant > 4 & quant < 5), fill = "cyan") +
geom_area(data = subset(df, quant > 5 & quant < 6), fill = "red") +
geom_line()
p
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "pink") +
geom_area(data = subset(df, quant >= 1 & quant < 2), fill = "red") +
geom_area(data = subset(df, quant >= 2 & quant < 3), fill = "lightgreen") +
geom_area(data = subset(df, quant >= 3 & quant < 4), fill = "green") +
geom_area(data = subset(df, quant >= 4 & quant < 5), fill = "cyan") +
geom_area(data = subset(df, quant >= 5 & quant < 6), fill = "red") +
geom_line()
p
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "black") +
geom_area(data = subset(df, quant >= 1 & quant < 2), fill = "red") +
geom_area(data = subset(df, quant >= 2 & quant < 3), fill = "lightgreen") +
geom_area(data = subset(df, quant >= 3 & quant < 4), fill = "green") +
geom_area(data = subset(df, quant >= 4 & quant < 5), fill = "cyan") +
geom_area(data = subset(df, quant >= 5 & quant < 6), fill = "red") +
geom_line()
p
df$quant
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "black") +
geom_area(data = subset(df, quant >= 1 & quant < 2), fill = "red") +
geom_area(data = subset(df, quant >= 2 & quant < 3), fill = "lightgreen") +
geom_area(data = subset(df, quant >= 3 & quant < 4), fill = "green") +
geom_area(data = subset(df, quant >= 4 & quant < 5), fill = "cyan") +
geom_area(data = subset(df, quant >= 5 & quant < 6), fill = "red") +
geom_area(data = subset(df, quant >= 6 & quant < 7), fill = "blue") +
geom_line()
p
df$y
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "black") +
geom_area(data = subset(df, quant >= 1 & quant < 2), fill = "red") +
geom_area(data = subset(df, quant >= 2 & quant < 3), fill = "lightgreen") +
geom_area(data = subset(df, quant >= 3 & quant < 4), fill = "green") +
geom_area(data = subset(df, quant >= 4 & quant < 5), fill = "cyan") +
geom_area(data = subset(df, quant >= 5 & quant < 6), fill = "red") +
geom_area(data = subset(df, quant >= 6 & quant < 7), fill = "#3182bd") +
geom_line()
p
df$quant
quantile(df$y, prob=probs)
probs=c(0.005,0.025, 0.25, 0.5, 0.75, 0.975,0.995)
quantiles <- quantile(df$y, prob=probs)
quantiles
probs=c(0.005,0.025, 0.25, 0.5, 0.75, 0.975,0.995)
quantile(df$y, prob=probs)
findInterval(df$y,quantiles)
df$y
findInterval(df$y,quantiles)
quantiles
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "black") +
geom_area(data = subset(df, quant >= 1 & quant < 2), fill = "red") +
geom_area(data = subset(df, quant >= 2 & quant < 3), fill = "lightgreen") +
geom_area(data = subset(df, quant >= 3 & quant < 4), fill = "green") +
geom_area(data = subset(df, quant >= 4 & quant < 5), fill = "cyan") +
geom_area(data = subset(df, quant >= 5 & quant < 6), fill = "red") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line()
p
quant
df$quant
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line()
p
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_bw()
p
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_wsj() + xlab("NA") + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_wsj() + xlab("NA") + ylab("Density") + scale_x_log10() +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_wsj() + xlab("NA") + ylab("Density") + scale_x_log10()
ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_wsj() + xlab("NA") + ylab("Density") + scale_x_log10() +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_wsj() + xlab("NA") + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_wsj() + xlab("N[A]~sigma*v") + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_wsj() + xlab(expression(N[A]~sigma*v)) + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
cmb
2.725*(1+3e8)
817500003/1e9
2.725*(1+4e8)
as.data.frame(filter(gg, x <= 1.1 & x >= 0.95))
cmb <- as.data.frame(filter(gg, x <= 1.1 & x >= 0.95))
cmbhist <- as.numeric(cmb)[1:Nsamp]
dens <- density(cmbhist)
df <- data.frame(x=dens$x, y=dens$y)
probs=c(0.005,0.025, 0.25, 0.5, 0.75, 0.975,0.995)
quantiles <- quantile(df$y, prob=probs)
df$quant <- findInterval(df$y,quantiles)
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_wsj() + xlab(expression(N[A]~sigma*v)) + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
cmb
as.numeric(cmb)[1:Nsamp]
cmb <- as.data.frame(filter(gg, x <= 1.1 & x >= 0.95))
as.numeric(cmb)
cmb
dim(cmb)
cmb <- as.data.frame(filter(gg, x <= 1.1 & x >= 0.99))
dim(cmb)
cmbhist <- as.numeric(cmb)[1:Nsamp]
dens <- density(cmbhist)
df <- data.frame(x=dens$x, y=dens$y)
probs=c(0.005,0.025, 0.25, 0.5, 0.75, 0.975,0.995)
quantiles <- quantile(df$y, prob=probs)
df$quant <- findInterval(df$y,quantiles)
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_wsj() + xlab(expression(N[A]~sigma*v)) + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
1000*0.05
1000*0.01
97*0.05
14.68/1000
2.99/100
985.32*0.05
985.32*0.15
22.02/1500
1527.24*0.05
8207/6755
6755*(1.2)
2000*0.05
2000*0.1
200-60
7078/6951.71
6951.71*1.01
6951.71/7078
6951.71*1.2
6951.71*1.02
6951.71*1.015
0.05*1500
ggplot(gg2data,aes(x=x,y=mean))+
theme_bw()  +
geom_ribbon(data=gg2data,aes(x=Tgrid,ymin=lwr3, ymax=upr3,y=NULL), fill=c("#deebf7"),show.legend=FALSE) +
geom_ribbon(data=gg2data,aes(x=Tgrid,ymin=lwr2, ymax=upr2,y=NULL), fill=c("#9ecae1"),show.legend=FALSE) +
geom_ribbon(data=gg2data,aes(x=Tgrid,ymin=lwr1, ymax=upr1,y=NULL), fill=c("#3182bd"),show.legend=FALSE) +
geom_line(size=1,colour="#ffffff",linetype="dashed",size=1,show.legend=FALSE) +
theme_wsj() + xlab("Temperature (GK)") + ylab(TeX('$N_A\\sigma v$')) +
#  scale_y_log10() + scale_x_log10()+
theme(legend.position = "none",
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
quantiles
dens$x
quantiles <- quantile(df$x, prob=probs)
df$quant <- findInterval(df$y,quantiles)
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_wsj() + xlab(expression(N[A]~sigma*v)) + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
df$quant <- findInterval(df$x,quantiles)
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 3), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 5 & quant < 7), fill = "#3182bd") +
geom_line() + theme_wsj() + xlab(expression(N[A]~sigma*v)) + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
df$quant
quantiles
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 2), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 2 & quant < 3), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 3 & quant < 5), fill = "#3182bd") +
geom_area(data = subset(df, quant >= 5 & quant < 6), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 6 & quant < 7), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 7), fill = "white") +
geom_line() + theme_wsj() + xlab(expression(N[A]~sigma*v)) + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
quantiles
df$quant
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 2), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 2 & quant < 3), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 3 & quant <= 5), fill = "#3182bd") +
geom_area(data = subset(df, quant > 5 & quant < 6), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 6 & quant < 7), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 7), fill = "white") +
geom_line() + theme_wsj() + xlab(expression(N[A]~sigma*v)) + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant >= 0 & quant < 1), fill = "white") +
geom_area(data = subset(df, quant >= 1 & quant < 2), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 2 & quant < 3), fill = "#9ecae1") +
geom_area(data = subset(df, quant >= 3 & quant <= 5), fill = "#3182bd") +
geom_area(data = subset(df, quant > 5 & quant <= 6), fill = "#9ecae1") +
geom_area(data = subset(df, quant > 6 & quant < 7), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 7), fill = "white") +
geom_line() + theme_wsj() + xlab(expression(N[A]~sigma*v)) + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant == 0), fill = "white") +
geom_area(data = subset(df, quant == 1), fill = "#deebf7") +
geom_area(data = subset(df, quant == 2), fill = "#9ecae1") +
geom_area(data = subset(df, quant == 3), fill = "#3182bd") +
geom_area(data = subset(df, quant == 4), fill = "#9ecae1") +
geom_area(data = subset(df, quant == 5), fill = "#3182bd") +
geom_area(data = subset(df, quant == 6), fill = "#deebf7") +
geom_area(data = subset(df, quant >= 7), fill = "white") +
geom_line() + theme_wsj() + xlab(expression(N[A]~sigma*v)) + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
quantiles
p <- ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant == 0), fill = "white") +
geom_area(data = subset(df, quant == 1), fill = "#deebf7") +
geom_area(data = subset(df, quant == 2), fill = "#9ecae1") +
geom_area(data = subset(df, quant == 3), fill = "#3182bd") +
geom_area(data = subset(df, quant == 4), fill = "#3182bd") +
geom_area(data = subset(df, quant == 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant == 6), fill = "#deebf7") +
geom_area(data = subset(df, quant == 7), fill = "white") +
geom_line() + theme_wsj() + xlab(expression(N[A]~sigma*v)) + ylab("Density") +
theme(legend.position = "top",
legend.background = element_rect(colour = "white", fill = "white"),
plot.background = element_rect(colour = "white", fill = "white"),
panel.background = element_rect(colour = "white", fill = "white"),
legend.key = element_rect(colour = "white", fill = "white"),
axis.title = element_text(color="#666666", face="bold", size=15),
axis.text  = element_text(size=12),
strip.text = element_text(size=10),
strip.background = element_rect("gray85")) +
ggtitle(expression(paste(NULL^"3","He(d,p)",NULL^"4","He")))
p
quantiles
findInterval(df$x,quantiles)
df$x
ggplot(df, aes(x, y)) +
geom_area(data = subset(df, quant == 0), fill = "white") +
geom_area(data = subset(df, quant == 1), fill = "#deebf7") +
geom_area(data = subset(df, quant == 2), fill = "#9ecae1") +
geom_area(data = subset(df, quant == 3), fill = "#3182bd") +
geom_area(data = subset(df, quant == 4), fill = "#3182bd") +
geom_area(data = subset(df, quant == 5), fill = "#9ecae1") +
geom_area(data = subset(df, quant == 6), fill = "#deebf7") +
geom_area(data = subset(df, quant == 7), fill = "white")
quantiles
