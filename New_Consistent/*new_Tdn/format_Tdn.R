# Read Dpg
require(ggplot2);require(ggthemes);require(dplyr);require(magrittr)

# Data of interest

## DATA SET 1: jarmie
obsx1    <- c(4.6809E-02, 4.6009E-02, 4.4007E-02, 4.2005E-02, 4.0004E-02,
              3.6001E-02, 3.1998E-02, 2.7996E-02, 2.3994E-02, 1.9992E-02,
              1.5990E-02, 1.1989E-02,  9.989E-03,  7.990E-03,  6.990E-03,
              5.990E-03,  4.992E-03)
obsy1    <- c(2.6640E+01, 2.6740E+01, 2.6300E+01, 2.6000E+01, 2.5280E+01,
              2.4020E+01, 2.2190E+01, 2.0700E+01, 1.8870E+01, 1.7350E+01,
              1.5810E+01, 1.4320E+01, 1.3920E+01, 1.3430E+01, 1.2830E+01,
              1.3480E+01, 1.2630E+01)
errobsy1 <- c(1.3853E-01, 1.2835E-01, 1.4202E-01, 1.2220E-01, 1.4157E-01,
              1.1289E-01, 1.1095E-01, 9.3150E-02, 7.9254E-02, 8.8485E-02,
              1.2964E-01, 9.7376E-02, 1.4059E-01, 2.6994E-01, 4.0414E-01,
              3.8553E-01, 5.7972E-01)


Jar84  <- data.frame(obsx1,obsy1,errobsy1) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst=0.0126) %>%
  mutate(.,dat="Jar84")



## DATA SET 2: brown
obsx2    <- c(4.7948E-02, 5.0947E-02, 5.3942E-02, 5.6942E-02, 5.9941E-02,
              6.2941E-02, 6.5941E-02, 6.9541E-02)
obsy2    <- c(2.6480E+01, 2.6840E+01, 2.5890E+01, 2.5500E+01, 2.4330E+01,
              2.3440E+01, 2.2020E+01, 2.0340E+01)
errobsy2 <- c(2.1184E-01, 2.1472E-01, 2.0712E-01, 2.0400E-01, 1.9464E-01,
              1.8752E-01, 1.7616E-01, 1.6272E-01)


Bro87 <- data.frame(obsx2,obsy2,errobsy2) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst = 2.30) %>%
  mutate(.,dat="Bro87")



## DATA SET 3: kobzev
obsx3    <- c( 46.0E-03,  48.0E-03,  52.0E-03,  56.0E-03,  60.0E-03,  64.0E-03,
               66.0E-03,  68.0E-03,  72.0E-03,  76.0E-03,  80.0E-03,  84.0E-03,
               88.0E-03,  92.0E-03,  96.0E-03, 100.0E-03, 104.0E-03, 108.0E-03,
               112.0E-03, 116.0E-03, 120.0E-03, 124.0E-03, 128.0E-03, 132.0E-03,
               136.0E-03, 140.0E-03, 144.0E-03, 148.0E-03, 152.0E-03, 156.0E-03,
               160.0E-03, 164.0E-03, 168.0E-03, 176.0E-03, 184.0E-03, 192.0E-03,
               200.0E-03, 208.0E-03, 216.0E-03, 224.0E-03, 232.0E-03, 240.0E-03,
               248.2E-03, 256.2E-03, 264.3E-03)
obsy3    <- c(    25.93,     25.96,     25.76,     25.28,     24.77,     23.66,
                  22.85,     21.89,     19.98,     18.14,     16.53,     15.01,
                  13.65,     12.50,     11.41,     10.45,      9.59,      8.76,
                  7.98,      7.28,      6.65,      6.08,      5.61,      5.23,
                  4.89,      4.60,      4.32,      4.11,      3.88,      3.69,
                  3.50,      3.32,      3.15,      2.84,      2.62,      2.42,
                  2.26,      2.13,      2.00,      1.89,      1.79,      1.69,
                  1.60,      1.51,      1.44)
errobsy3 <- c(     0.52,      0.52,      0.52,      0.51,      0.50,      0.47,
                   0.46,      0.44,      0.40,      0.36,      0.33,      0.30,
                   0.27,      0.25,      0.23,      0.21,      0.19,      0.18,
                   0.16,      0.15,      0.13,      0.12,      0.11,      0.10,
                   0.10,      0.09,      0.09,      0.08,      0.08,      0.07,
                   0.07,      0.08,      0.08,      0.07,      0.07,      0.06,
                   0.06,      0.05,      0.05,      0.05,      0.04,      0.04,
                   0.04,      0.04,      0.04)


Kob66 <- data.frame(obsx3,obsy3,errobsy3) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst=0.025) %>%
  mutate(.,dat="Kob66")





## DATA SET 4: arnold
obsx4    <- c(0.029951,  0.026383,  0.026095,  0.043292, 0.0093180,  0.020273,
              0.031522,  0.014679,  0.037164,  0.025724,  0.025664,  0.037002,
              0.014481,  0.031162,  0.019925, 0.0089763,  0.042495,  0.025322,
              0.0095159, 0.0094739,  0.014894,  0.012826,  0.012808,  0.047250,
              0.047220,  0.018348,  0.018330,  0.041254,  0.041230,  0.023973,
              0.023955,  0.035383,  0.035359,  0.052826,  0.052796,  0.058678,
              0.058660,  0.064543,  0.064513,  0.070443,  0.070395,  0.067391,
              0.067373,  0.061431,  0.061395,  0.046650,  0.046638,  0.046614,
              0.012034,  0.011992,  0.011950,  0.025262,  0.025166)
obsy4    <- c(  21.766,    20.525,    20.277,    27.067,    13.703,    17.721,
                22.695,    15.753,    25.184,    20.596,    19.920,    24.967,
                14.939,    22.749,    17.249,    13.340,    26.847,    19.969,
                13.600,    13.508,    15.448,    14.957,    14.302,    27.542,
                27.505,    16.989,    16.921,    26.514,    26.600,    18.366,
                18.969,    24.589,    24.314,    27.085,    26.975,    25.669,
                25.621,    23.157,    23.071,    20.227,    20.445,    21.951,
                22.002,    24.492,    24.593,    27.489,    27.365,    27.466,
                13.680,    13.849,    14.068,    20.755,    20.718)
errobsy4 <- c(0.021766,  0.020525,  0.020277,  0.027067,  0.027400,  0.035400,
              0.022695,  0.031400,  0.025184,  0.020596,  0.019920,  0.024967,
              0.030000,  0.022749,  0.034400,  0.026700,  0.026847,  0.019969,
              0.027200,  0.027000,  0.030000,  0.030000,  0.029000,  0.027542,
              0.027505,  0.032000,  0.034000,  0.026514,  0.026600,  0.036000,
              0.038000,  0.024589,  0.024314,  0.027085,  0.026975,  0.025669,
              0.025621,  0.023157,  0.023071,  0.020227,  0.020445,  0.021951,
              0.022002,  0.024492,  0.024593,  0.027489,  0.027365,  0.027466,
              0.027000,  0.028000,  0.028000,  0.020755,  0.020718)



Arn53 <- data.frame(obsx4,obsy4,errobsy4) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst=0.020) %>%
  mutate(.,dat="Arn53")



## DATA SET 5: conner
obsx5    <- c(1.2420E-02, 1.5480E-02, 1.8600E-02, 2.0700E-02, 2.1780E-02, 2.4900E-02,
              2.8020E-02, 2.9100E-02, 3.1200E-02, 3.3240E-02, 3.4260E-02, 3.7380E-02,
              4.0500E-02, 4.1580E-02, 4.3680E-02, 4.5720E-02, 4.6800E-02, 4.9980E-02,
              5.4180E-02, 5.6220E-02, 5.8260E-02, 6.2400E-02, 6.5400E-02, 6.6600E-02,
              6.9000E-02, 7.5000E-02, 8.0400E-02, 8.1600E-02, 8.5800E-02, 8.7600E-02,
              9.1800E-02, 9.3600E-02, 9.7200E-02, 1.0020E-01, 1.0380E-01, 1.0980E-01,
              1.2300E-01, 1.3620E-01, 1.5060E-01, 1.6560E-01, 1.8120E-01, 1.9740E-01,
              2.1420E-01)
obsy5    <- c(1.3227E+01, 1.5174E+01, 1.5790E+01, 1.7328E+01, 1.7378E+01, 1.8234E+01,
              1.9699E+01, 2.0129E+01, 2.1804E+01, 2.2911E+01, 2.1594E+01, 2.3803E+01,
              2.5309E+01, 2.5725E+01, 2.5930E+01, 2.5899E+01, 2.5439E+01, 2.6833E+01,
              2.5526E+01, 2.6602E+01, 2.5886E+01, 2.4608E+01, 2.3429E+01, 2.2901E+01,
              2.1818E+01, 1.9229E+01, 1.6970E+01, 1.6604E+01, 1.4961E+01, 1.4266E+01,
              1.2897E+01, 1.2332E+01, 1.1024E+01, 1.0626E+01, 9.9085E+00, 8.9950E+00,
              6.7947E+00, 5.4398E+00, 4.4269E+00, 3.5523E+00, 2.8963E+00, 2.5082E+00,
              2.1603E+00)
errobsy5 <- c(      0.13,       0.15,       0.16,       0.17,       0.17,       0.18,
                    0.20,       0.20,       0.22,       0.23,       0.21,       0.24,
                    0.25,       0.26,       0.26,       0.26,       0.25,       0.27,
                    0.26,       0.27,       0.26,       0.25,       0.23,       0.23,
                    0.22,       0.20,       0.17,       0.17,       0.15,       0.14,
                    0.13,       0.12,       0.11,       0.11,       0.10,       0.09,
                    0.07,       0.05,       0.04,       0.04,       0.03,       0.03,
                    0.02)

Con52  <- data.frame(obsx5,obsy5,errobsy5) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst=0.018) %>%
  mutate(.,dat = "Con52 ")


Tdn  <- rbind(Jar84,Bro87,Kob66,Arn53,Con52)

save(Tdn, file = "Tdn.RData")


#pdf("plot/3Hedp_data.pdf",height = 7,width = 8)
ggplot(Tdn,aes(x=E,y=S,group=dat,shape=dat,color=dat))+
  geom_point(size=2)+
  geom_errorbar(show.legend = FALSE,aes(x=E,y=S,ymin=S-Stat,ymax=S+Stat),width=0.025)+
  scale_shape_stata(name="Dataset")+
  scale_color_stata(name="Dataset")+
  scale_x_log10() +
  theme_bw() + xlab("Energy (MeV)") + ylab("S-Factor (MeV b)") +
  theme(legend.position = "top",
        legend.background = element_rect(colour = "white", fill = "white"),
        plot.background = element_rect(colour = "white", fill = "white"),
        panel.background = element_rect(colour = "white", fill = "white"),
        legend.key = element_rect(colour = "white", fill = "white"),
        axis.title = element_text(color="#666666", face="bold", size=15),
        axis.text  = element_text(size=12),
        strip.text = element_text(size=10),
        strip.background = element_rect("gray85"))
#dev.off()

