# Read Dpg
require(ggplot2);require(ggthemes);require(dplyr);require(magrittr)

# Data of interest

## DATA SET 1: jarmie
obsx1    <- c(4.6809E-02, 4.6009E-02, 4.4007E-02, 4.2005E-02, 4.0004E-02,
              3.6001E-02, 3.1998E-02, 2.7996E-02, 2.3994E-02, 1.9992E-02,
              1.5990E-02, 1.1989E-02,  9.989E-03,  7.990E-03,  6.990E-03,
              5.990E-03,  4.992E-03)
obsy1    <- c(2.6640E+01, 2.6740E+01, 2.6300E+01, 2.6000E+01, 2.5280E+01,
              2.4020E+01, 2.2190E+01, 2.0700E+01, 1.8870E+01, 1.7350E+01,
              1.5810E+01, 1.4320E+01, 1.3920E+01, 1.3430E+01, 1.2830E+01,
              1.3480E+01, 1.2630E+01)
errobsy1 <- c(1.3853E-01, 1.2835E-01, 1.4202E-01, 1.2220E-01, 1.4157E-01,
              1.1289E-01, 1.1095E-01, 9.3150E-02, 7.9254E-02, 8.8485E-02,
              1.2964E-01, 9.7376E-02, 1.4059E-01, 2.6994E-01, 4.0414E-01,
              3.8553E-01, 5.7972E-01)


Jar84  <- data.frame(obsx1,obsy1,errobsy1) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst=0.0126) %>%
  mutate(.,dat="Jar84")



## DATA SET 2: brown
obsx2    <- c(4.7948E-02, 5.0947E-02, 5.3942E-02, 5.6942E-02, 5.9941E-02,
              6.2941E-02, 6.5941E-02, 6.9541E-02)
obsy2    <- c(2.6480E+01, 2.6840E+01, 2.5890E+01, 2.5500E+01, 2.4330E+01,
              2.3440E+01, 2.2020E+01, 2.0340E+01)
errobsy2 <- c(2.1184E-01, 2.1472E-01, 2.0712E-01, 2.0400E-01, 1.9464E-01,
              1.8752E-01, 1.7616E-01, 1.6272E-01)


Bro87 <- data.frame(obsx2,obsy2,errobsy2) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst=0.078) %>%
  mutate(.,dat="Bro87")



## DATA SET 3: moeller
obsx3    <- c( 8.5600E-02, 1.4600E-01, 1.7360E-01, 2.0560E-01, 2.1960E-01,
               2.3360E-01, 2.6680E-01, 2.9640E-01, 3.0880E-01, 3.2800E-01,
               3.8560E-01, 4.4600E-01 )
obsy3    <- c( 7.1730E+00, 1.4182E+01, 1.6676E+01, 1.8580E+01, 1.7239E+01,
               1.7646E+01, 1.4769E+01, 1.3223E+01, 1.1221E+01, 1.0157E+01,
               7.3423E+00, 5.0221E+00 )
errobsy3 <- c( 5.0211E-01, 4.2545E-01, 5.0027E-01, 5.5739E-01, 5.1717E-01,
               5.2937E-01, 4.4306E-01, 3.9670E-01, 3.3662E-01, 3.0472E-01,
               2.2027E-01, 1.5066E-01 )


Moe80 <- data.frame(obsx3,obsy3,errobsy3) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst=0.039) %>%
  mutate(.,Kinematics = "Direct") %>%
  mutate(.,dat="Moe80")


## DATA SET 4: zhichang
obsx4    <- c( 1.3440E-01, 1.4220E-01, 1.5060E-01, 1.6500E-01, 1.6770E-01,
               1.6920E-01, 1.7460E-01, 1.8000E-01, 1.8540E-01, 1.9140E-01,
               1.9740E-01, 2.0400E-01, 2.1000E-01, 2.2470E-01, 2.4000E-01,
               2.5200E-01, 2.5590E-01, 2.6760E-01, 2.7360E-01, 2.7480E-01,
               2.9490E-01, 3.1860E-01, 3.4680E-01, 3.8220E-01, 4.1100E-01,
               4.3140E-01 )
obsy4    <- c( 1.0074E+01, 1.2080E+01, 1.2544E+01, 1.2375E+01, 1.4590E+01,
               1.5314E+01, 1.5760E+01, 1.5987E+01, 1.7415E+01, 1.8116E+01,
               1.7763E+01, 1.7728E+01, 1.7825E+01, 1.7502E+01, 1.6640E+01,
               1.5987E+01, 1.5950E+01, 1.4505E+01, 1.4194E+01, 1.4231E+01,
               1.2757E+01, 1.0505E+01, 9.1881E+00, 6.7735E+00, 5.8631E+00,
               5.0714E+00 )
errobsy4 <- c( 6.0443E-02, 7.2483E-02, 7.5261E-02, 7.4252E-02, 8.7540E-02,
               9.1881E-02, 9.4560E-02, 9.5924E-02, 1.0449E-01, 1.0870E-01,
               1.0658E-01, 1.0637E-01, 1.0695E-01, 1.0501E-01, 9.9841E-02,
               9.5923E-02, 9.5702E-02, 8.7030E-02, 8.5162E-02, 8.5388E-02,
               7.6542E-02, 6.3032E-02, 5.5129E-02, 4.0641E-02, 3.5178E-02,
               3.0429E-02 )


Zhi77 <- data.frame(obsx4,obsy4,errobsy4) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst=0.034) %>%
  mutate(.,Kinematics = "Direct") %>%
  mutate(.,dat="Zhi77")



## DATA SET 5: costantini [inverse kinematics]
obsx5    <- c( 0.00422, 0.00459, 0.00471, 0.00500, 0.00509, 0.00537, 
               0.00544, 0.00551, 0.00554, 0.00577, 0.00583, 0.00590,
               0.00593, 0.00623, 0.00631, 0.00652, 0.00657, 0.00672,
               0.00700, 0.00707, 0.00734, 0.00740, 0.00746, 0.00752,
               0.00812, 0.00819, 0.00822, 0.00829, 0.00834, 0.00851,
               0.00860, 0.00871, 0.00898, 0.00908, 0.00914, 0.00929,
               0.00938, 0.00948, 0.00978, 0.00987, 0.00991, 0.01007,
               0.01018, 0.01029, 0.01087, 0.01096, 0.01105, 0.01165,
               0.01178, 0.01185, 0.01241, 0.01255, 0.01265, 0.01307,
               0.01383 )
obsy5    <- c(   9.700,   9.000,   8.090,   8.950,   9.820,   8.860,
                 8.010,   9.680,   8.870,   8.990,   8.930,   8.740,
                 8.310,   8.150,   8.100,   8.260,   8.030,   8.320,
                 7.900,   8.320,   7.700,   7.690,   7.900,   7.830,
                 7.310,   7.310,   7.430,   7.850,   7.510,   7.380,
                 7.650,   7.820,   7.360,   7.660,   7.600,   7.540,
                 7.470,   7.590,   7.320,   7.520,   7.240,   7.390,
                 7.350,   7.440,   7.380,   7.350,   7.410,   7.240,
                 7.210,   7.350,   7.580,   7.310,   7.310,   7.360,
                 7.230 )
errobsy5 <- c(   1.650,  0.6700,  0.6200,  0.7000,   1.010,  0.4800,
                 0.3900,  0.7000,  0.5500,  0.3100,  0.3600,  0.2500,
                 0.5500,  0.2900,  0.2300,  0.4800,  0.2600,  0.1600,
                 0.2700,  0.2800,  0.1600,  0.1500,  0.1800,  0.2600,
                 0.1100,  0.2500,  0.2400,  0.2400,  0.2200,  0.2200,
                 0.2300,  0.2800,  0.1900,  0.1700,  0.2400,  0.2300,
                 0.1400,  0.1300,  0.2200,  0.1900,  0.1800,  0.1900,
                 0.1400,  0.1700,  0.1600,  0.1300,  0.1700,  0.1400,
                 0.1200,  0.1100,  0.1400,  0.1300,  0.1400,  0.1300,
                 0.1300 )

Cos00 <- data.frame(obsx5,obsy5,errobsy5) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst=0.055) %>%
  mutate(.,Kinematics= "Inverse") %>%
  mutate(.,dat = "Cos00")

## DATA SET 6: aliotta_a
obsx6    <- c( 0.00501, 0.00550, 0.00601, 0.00602, 0.00645, 0.00690,
               0.00751, 0.00780, 0.00818, 0.00896, 0.00902, 0.00966,
               0.01072, 0.01144, 0.01199, 0.01318, 0.01439, 0.01499,
               0.01675, 0.01799, 0.01914, 0.02094, 0.02155, 0.02271,
               0.02393, 0.02508, 0.02662, 0.02873, 0.02991, 0.03110,
               0.03289, 0.03349, 0.03586, 0.03858, 0.04067, 0.04187, 
               0.04306, 0.04485, 0.04544, 0.04786, 0.05021, 0.05083,
               0.05265, 0.05382, 0.05504, 0.05681, 0.05741, 0.05980 )
obsy6    <- c(   10.76,   10.31,    9.41,   10.37,    9.36,    8.82,
                 9.12,    8.66,    8.31,    7.85,    7.88,    7.68,
                 7.48,    7.29,    7.35,    7.28,    7.04,    7.07,
                 7.16,    7.02,     7.2,    6.81,    7.09,    7.13,
                 6.91,    7.18,    6.93,    7.22,    6.87,    7.24,
                 7.04,    7.33,    7.22,    7.33,    7.44,    7.29,
                 7.48,     7.4,     7.7,    7.63,    7.66,     7.7,
                 7.7,    7.77,    7.77,    7.88,    7.94,    8.12 )
errobsy6 <- c(    1.47,    0.81,    0.48,    0.35,    0.35,    0.31,
                  0.29,    0.28,    0.24,    0.26,    0.22,    0.22,
                  0.2,     0.2,     0.2,     0.2,     0.2,     0.2,
                  0.2,     0.2,     0.2,    0.18,     0.2,     0.2,
                  0.18,     0.2,    0.18,     0.2,    0.18,     0.2,
                  0.2,     0.2,    0.18,    0.18,    0.22,     0.2,
                  0.22,     0.2,    0.22,     0.2,    0.22,     0.2,
                  0.22,    0.22,    0.22,     0.2,    0.22,    0.22 )


Ali01a <- data.frame(obsx6,obsy6,errobsy6) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst=0.030) %>%
  mutate(.,Kinematics= "Direct") %>%
  mutate(.,dat = "Ali01a")


## DATA SET 7: aliotta_b [inverse kinematics]
obsx7    <- c( 0.01195, 0.01395, 0.01595, 0.01794, 0.01993, 0.02192,
               0.02392, 0.02592, 0.02788, 0.02988, 0.03190, 0.03389,
               0.03589, 0.03589, 0.03788, 0.03987 )
obsy7    <- c(    7.19,    6.95,    6.87,    6.91,    6.75,    6.96,
                  6.92,    7.17,    7.01,    7.19,    7.17,    7.43,
                  7.39,    7.58,    7.63,    7.65 )
errobsy7 <- c(    0.35,    0.23,    0.18,    0.19,    0.18,    0.19,
                  0.19,    0.19,    0.19,    0.19,    0.19,     0.2,
                  0.19,     0.2,     0.2,     0.2 )

Ali01b <- data.frame(obsx7,obsy7,errobsy7) %>%
  set_colnames(c("E","S","Stat")) %>%
  mutate(.,Syst=0.030) %>%
  mutate(.,Kinematics= "Inverse") %>%
  mutate(.,dat = "Ali01b")


He3dp  <- rbind(Gei99,Kra87,Moe80,Zhi77,Cos00,Ali01a,Ali01b)

save(He3dp, file = "He3dp.RData")


#pdf("plot/3Hedp_data.pdf",height = 7,width = 8)
ggplot(He3dp,aes(x=E,y=S,group=dat,shape=dat,color=dat))+
  geom_point(size=2)+
  geom_errorbar(show.legend = FALSE,aes(x=E,y=S,ymin=S-Stat,ymax=S+Stat),width=0.025)+
  scale_shape_stata(name="Dataset")+
  scale_color_stata(name="Dataset")+
  scale_x_log10() +
  theme_bw() + xlab("Energy (MeV)") + ylab("S-Factor (MeV b)") + 
  theme(legend.position = "top",
        legend.background = element_rect(colour = "white", fill = "white"),
        plot.background = element_rect(colour = "white", fill = "white"),
        panel.background = element_rect(colour = "white", fill = "white"),
        legend.key = element_rect(colour = "white", fill = "white"),
        axis.title = element_text(color="#666666", face="bold", size=15),
        axis.text  = element_text(size=12),
        strip.text = element_text(size=10),
        strip.background = element_rect("gray85")) 
#dev.off()

